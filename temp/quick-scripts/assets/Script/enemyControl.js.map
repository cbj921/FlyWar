{"version":3,"sources":["enemyControl.js"],"names":["cc","Class","extends","Component","properties","UFOPrefab","Prefab","rocketPrefab","waveRobotPrefab","throwRobotPrefab","spacePlanePrefab","heavyWaterPlanePrefab","enemyNumberBar","ProgressBar","failButton","Node","initLevelData","levelData","JSON","parse","sys","localStorage","getItem","init","makeDoneFlag","enemyArray","active","node","startGame","gameState","enemyNumber","remainEnemy","UFOTotalNumber","Math","floor","enmeyProportion","UFOProportion","makeUFOEnemyNumber","rocketTotalNumber","rocketProportion","makeRocketEnemyNumber","waveRobotTotalNumber","waveRobotProportion","makeWaveRobotEnemyNumber","spacePlaneTotalNumber","spacePlaneProportion","makeSpacePlaneEnemyNumber","throwRobotTotalNumber","throwRobotProportion","makeThrowRobotEnemyNumber","heavyPlaneTotalNumber","heavyPlaneProportion","makeHeavyPlaneEnemyNumber","makeEnemy","enemyFlag","randomEnemy","creatUFOEnemy","creatRocketEnemy","creatWaveRobotEnemy","creatSpacePlaneEnemy","creatThrowRobotEnemy","creaheavyWaterPlaneEnemy","schedule","randomNumber","random","enemy","instantiate","parent","push","succeedEventEmit","map","item","removeByValue","length","emit","popFailButton","updateEnemyNumberBar","ratio","progress","clearAllEnemy","unscheduleAllCallbacks","destroy","initEnemyData","UFOInitData","rocketInitData","waveRobotInitData","spacePlaneInitData","arr","val","i","splice","UFOObject","bulletAttack","impactAttack","health","bulletSpeed","bulletFre","coin","setItem","stringify","rocketObject","speed","waveRobotObject","spacePlaneObject","onLoad","start","update","dt"],"mappings":"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","file":"enemyControl.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        UFOPrefab: cc.Prefab,\n        rocketPrefab: cc.Prefab,\n        waveRobotPrefab: cc.Prefab,\n        throwRobotPrefab: cc.Prefab,\n        spacePlanePrefab: cc.Prefab,\n        heavyWaterPlanePrefab: cc.Prefab,\n\n        enemyNumberBar: cc.ProgressBar,\n        failButton: cc.Node,\n    },\n\n    initLevelData() {\n        let levelData = JSON.parse(cc.sys.localStorage.getItem(\"levelData\")); // 获取全局对象\n        return levelData;\n    },\n\n    init() {\n        this.levelData = this.initLevelData(); // 获得关卡数据\n        // 为什么makeDoneFlag 为 -1 ？？？\n        this.makeDoneFlag = -1; // 有点奇怪初始值为-1，这个变量为标志位，当它的值等于敌人的数量时，说明敌人的生成已经完成\n        this.enemyArray = [];\n        this.failButton.active = false; // 初始让失败按钮不可见\n        this.enemyNumberBar.node.active = false; //初始让敌人条不可见\n    },\n\n    startGame() {\n        this.gameState = 1; // 游戏开始的标记\n        let enemyNumber = this.levelData.enemyNumber; // 获得敌人数量\n        this.remainEnemy = this.levelData.enemyNumber;// 让剩余敌人的变量等于初始人数\n        /********************************************/\n        this.UFOTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.UFOProportion);//生成总的UFO数量\n        this.makeUFOEnemyNumber = 0; // 这个用来计数生成的UFO数量\n\n        this.rocketTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.rocketProportion);//生成总的rocket数量\n        this.makeRocketEnemyNumber = 0; // 这个用来计数生成的rocket数量\n\n        this.waveRobotTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.waveRobotProportion);//生成总的wave数量\n        this.makeWaveRobotEnemyNumber = 0; // 这个用来计数生成的wave数量\n\n        this.spacePlaneTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.spacePlaneProportion);\n        this.makeSpacePlaneEnemyNumber = 0;\n\n        this.throwRobotTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.throwRobotProportion);\n        this.makeThrowRobotEnemyNumber = 0;\n\n        this.heavyPlaneTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.heavyPlaneProportion);\n        this.makeHeavyPlaneEnemyNumber = 0;\n        /********************************************/\n        ///以下用创建敌人函数代替\n        this.makeEnemy = () => {\n            let enemyFlag = this.randomEnemy(); //获取到随机生成的敌人\n            if (enemyFlag == 'UFO') {\n                this.creatUFOEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'rocket') {\n                this.creatRocketEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'waveRobot') {\n                this.creatWaveRobotEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'spacePlane') {\n                this.creatSpacePlaneEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'throwRobot') {\n                this.creatThrowRobotEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag = 'heavyWaterPlane') {\n                this.creaheavyWaterPlaneEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == null && this.makeDoneFlag < enemyNumber) {\n                // 这个是当所有敌人都生成完，但是敌人数还不为总敌人数时调用；因为floor的原因，有可能丢失敌人数\n            }\n        };\n        this.schedule(this.makeEnemy, 2, enemyNumber);\n        this.enemyNumberBar.node.active = true; //开始游戏后敌人条可见\n    },\n    randomEnemy() {\n        let randomNumber = Math.floor(Math.random() * 100); //得到一个0-100之间的值\n        let enemyFlag = null;\n        if (randomNumber < 25 && this.makeUFOEnemyNumber < this.UFOTotalNumber) {\n            enemyFlag = 'UFO';\n        }\n        if ((randomNumber >= 25 && randomNumber < 50) && this.makeRocketEnemyNumber < this.rocketTotalNumber) {\n            enemyFlag = 'rocket';\n        }\n        if ((randomNumber >= 50 && randomNumber < 70) && this.makeWaveRobotEnemyNumber < this.waveRobotTotalNumber) {\n            enemyFlag = 'waveRobot';\n        }\n        if ((randomNumber >= 70 && randomNumber < 80) && this.makeSpacePlaneEnemyNumber < this.spacePlaneTotalNumber) {\n            enemyFlag = 'spacePlane';\n        }\n        if ((randomNumber >= 80 && randomNumber < 90) && this.makeThrowRobotEnemyNumber < this.throwRobotTotalNumber) {\n            enemyFlag = 'throwRobot';\n        }\n        if ((randomNumber >= 90 && randomNumber <= 100) && this.makeHeavyPlaneEnemyNumber < this.heavyPlaneTotalNumber) {\n            enemyFlag = 'heavyWaterPlane';\n        }\n        return enemyFlag;\n    },\n    creatUFOEnemy() {\n        // 创建UFO\n        if (this.makeUFOEnemyNumber < this.UFOTotalNumber) {\n            // 生成UFO\n            let enemy = cc.instantiate(this.UFOPrefab);\n            enemy.parent = this.node;\n            this.enemyArray.push(enemy);\n            this.makeUFOEnemyNumber++;\n        }\n    },\n    creatRocketEnemy() {\n        // 创建火箭\n    },\n    creatWaveRobotEnemy() {\n        // 创建波动机器人\n    },\n    creatSpacePlaneEnemy() {\n        // 创建深空飞船\n    },\n    creatThrowRobotEnemy() {\n        // 创建投掷机器人\n    },\n    creaheavyWaterPlaneEnemy() {\n        // 创建重水飞船\n    },\n\n    succeedEventEmit() {\n        if (this.gameState == 1) { // gameState代表游戏状态 0：未开始，1：开始\n            this.enemyArray.map((item) => {\n                if (item.active == false) {\n                    item.parent = null;\n                    this.removeByValue(this.enemyArray, item);\n                    this.remainEnemy--; // 每移出一个敌人剩余敌人数减1\n                }\n            });\n            if ((this.makeDoneFlag == this.levelData.enemyNumber) && (this.enemyArray.length == 0)) {\n                this.node.emit(\"succeed\");\n                this.makeDoneFlag = -1;\n                this.gameState = 0;\n            }\n        }\n    },\n\n    popFailButton() {\n        //弹出失败重来按钮\n        this.failButton.active = true;\n        this.gameState = 0; // gameState == 0,表明游戏结束\n    },\n\n    updateEnemyNumberBar() {\n        // 更新敌人数量条\n        if (this.gameState == 1) {\n            let ratio = this.remainEnemy / this.levelData.enemyNumber;\n            this.enemyNumberBar.progress = ratio;\n        }\n    },\n\n    clearAllEnemy() {\n        // 停止所有计时器\n        // 将全局数组里面的敌人都销毁就好了\n        this.unscheduleAllCallbacks();\n        this.enemyArray.map((item) => {\n            item.parent = null;\n            item.destroy(); //销毁数组中的节点\n        });\n        this.enemyArray = []; //清空数组\n        this.makeDoneFlag = -1; // 将标志位设回原样\n    },\n\n    initEnemyData() {\n        // 这里必须初始化一次，否则第一次进游戏会出错\n        this.UFOInitData();\n        this.rocketInitData();\n        this.waveRobotInitData();\n        this.spacePlaneInitData();\n    },\n\n    // 删除数组特定元素的方法\n    removeByValue(arr, val) {\n        for (let i = 0; i < arr.length; i++) {\n            if (arr[i] == val) {\n                arr.splice(i, 1);\n                break;\n            }\n        }\n    },\n\n\n\n    /*初始化数据*/\n    UFOInitData() {\n        this.UFOObject = JSON.parse(cc.sys.localStorage.getItem(\"UFOObject\")); // 获取全局对象\n        if (this.UFOObject == null) {\n            this.UFOObject = {\n                bulletAttack: 20, // 子弹攻击力\n                impactAttack: 40, // 撞击攻击力\n                health: 100,  // 初始血量\n                bulletSpeed: 10, // 初始子弹速度\n                bulletFre: 2.5, // 子弹频率\n                coin: 100,\n            };\n            cc.sys.localStorage.setItem(\"UFOObject\", JSON.stringify(this.UFOObject));\n        } // 初始化数据\n    },\n    rocketInitData() {\n        this.rocketObject = JSON.parse(cc.sys.localStorage.getItem(\"rocketObject\")); // 获取全局对象\n        if (this.rocketObject == null) {\n            this.rocketObject = {\n                impactAttack: 40, // 撞击攻击力\n                health: 50,  // 初始血量\n                speed: 5, // 初始速度\n                coin: 200,\n            };\n            cc.sys.localStorage.setItem(\"rocketObject\", JSON.stringify(this.rocketObject));\n        } // 初始化数据\n    },\n    waveRobotInitData() {\n        this.waveRobotObject = JSON.parse(cc.sys.localStorage.getItem(\"waveRobotObject\")); // 获取全局对象\n        if (this.waveRobotObject == null) {\n            this.waveRobotObject = {\n                bulletAttack: 50, // 子弹攻击力\n                impactAttack: 120, // 撞击攻击力\n                health: 250,  // 初始血量\n                bulletSpeed: 5, // 初始子弹速度\n                bulletFre: 4, // 子弹频率\n                coin: 300,\n            };\n            cc.sys.localStorage.setItem(\"waveRobotObject\", JSON.stringify(this.waveRobotObject));\n        } // 初始化数据\n    },\n    spacePlaneInitData() {\n        this.spacePlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"spacePlaneObject\")); // 获取全局对象\n        if (this.spacePlaneObject == null) {\n            this.spacePlaneObject = {\n                bulletAttack: 200, // 子弹攻击力\n                impactAttack: 600, // 撞击攻击力\n                health: 800,  // 初始血量\n                bulletSpeed: 1, // 初始子弹速度\n                bulletFre: 4, // 子弹频率\n                coin: 700,\n            };\n            cc.sys.localStorage.setItem(\"spacePlaneObject\", JSON.stringify(this.spacePlaneObject));\n        } // 初始化数据\n    },\n    /**********************/\n\n    onLoad() {\n        this.enemyNumberBar.progress = -1;\n    },\n\n    start() {\n\n    },\n\n    update(dt) {\n        this.succeedEventEmit();\n        this.updateEnemyNumberBar();\n        //cc.log('enemy:'+this.enemyArray.length);\n        //cc.log('flag:'+this.makeDoneFlag)\n    },\n});\n"]}