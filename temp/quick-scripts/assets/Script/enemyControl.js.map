{"version":3,"sources":["enemyControl.js"],"names":["ENEMYTYPE_1","ENEMYTYPE_2","ENEMYTYPE_3","cc","Class","extends","Component","properties","UFOPrefab","Prefab","rocketPrefab","waveRobotPrefab","throwRobotPrefab","spacePlanePrefab","heavyWaterPlanePrefab","enemyNumberBar","ProgressBar","failButton","Node","initLevelData","levelData","JSON","parse","sys","localStorage","getItem","init","makeDoneFlag","enemyArray","active","node","startGame","gameState","enemyNumber","remainEnemy","makeEnemy","enemyFlag","randomEnemy","creatUFOEnemy","creatRocketEnemy","creatWaveRobotEnemy","creatSpacePlaneEnemy","creatThrowRobotEnemy","creatHeavyWaterPlaneEnemy","schedule","level","randomNumber","Math","floor","random","length","enemy","instantiate","parent","push","succeedEventEmit","map","item","removeByValue","emit","popFailButton","updateEnemyNumberBar","ratio","progress","clearAllEnemy","unscheduleAllCallbacks","destroy","initEnemyData","UFOInitData","rocketInitData","waveRobotInitData","spacePlaneInitData","throwRobotInitData","arr","val","i","splice","UFOObject","bulletAttack","impactAttack","health","bulletSpeed","bulletFre","coin","setItem","stringify","rocketObject","speed","waveRobotObject","spacePlaneObject","throwRobotObject","heavyPlaneInitData","heavyPlaneObject","onLoad","start","update","dt"],"mappings":"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","file":"enemyControl.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const ENEMYTYPE_1 = ['UFO','rocket'];\nconst ENEMYTYPE_2 = ['UFO','rocket','waveRobot','throwRobot'];\nconst ENEMYTYPE_3 = ['UFO','rocket','waveRobot','throwRobot','spacePlane','heavyWaterPlane'];\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        UFOPrefab: cc.Prefab,\n        rocketPrefab: cc.Prefab,\n        waveRobotPrefab: cc.Prefab,\n        throwRobotPrefab: cc.Prefab,\n        spacePlanePrefab: cc.Prefab,\n        heavyWaterPlanePrefab: cc.Prefab,\n\n        enemyNumberBar: cc.ProgressBar,\n        failButton: cc.Node,\n    },\n\n    initLevelData() {\n        let levelData = JSON.parse(cc.sys.localStorage.getItem(\"levelData\")); // 获取全局对象\n        return levelData;\n    },\n\n    init() {\n        this.levelData = this.initLevelData(); // 获得关卡数据\n        // 为什么makeDoneFlag 为 -1 ？？？\n        this.makeDoneFlag = -1; // 有点奇怪初始值为-1，这个变量为标志位，当它的值等于敌人的数量时，说明敌人的生成已经完成\n        this.enemyArray = [];\n        this.failButton.active = false; // 初始让失败按钮不可见\n        this.enemyNumberBar.node.active = false; //初始让敌人条不可见\n    },\n\n    startGame() {\n        this.gameState = 1; // 游戏开始的标记\n        let enemyNumber = this.levelData.enemyNumber; // 获得敌人数量\n        this.remainEnemy = this.levelData.enemyNumber;// 让剩余敌人的变量等于初始人数\n        /********************************************/\n        /*this.UFOTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.UFOProportion);//生成总的UFO数量\n        this.makeUFOEnemyNumber = 0; // 这个用来计数生成的UFO数量\n\n        this.rocketTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.rocketProportion);//生成总的rocket数量\n        this.makeRocketEnemyNumber = 0; // 这个用来计数生成的rocket数量\n\n        this.waveRobotTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.waveRobotProportion);//生成总的wave数量\n        this.makeWaveRobotEnemyNumber = 0; // 这个用来计数生成的wave数量\n\n        this.spacePlaneTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.spacePlaneProportion);\n        this.makeSpacePlaneEnemyNumber = 0;\n\n        this.throwRobotTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.throwRobotProportion);\n        this.makeThrowRobotEnemyNumber = 0;\n\n        this.heavyPlaneTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.heavyPlaneProportion);\n        this.makeHeavyPlaneEnemyNumber = 0;*/\n        /********************************************/\n        ///以下用创建敌人函数代替\n        this.makeEnemy = () => {\n            let enemyFlag = this.randomEnemy(); //获取到随机生成的敌人\n\n            if (enemyFlag == 'UFO' ) {\n                this.creatUFOEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'rocket') {\n                this.creatRocketEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'waveRobot') {\n                this.creatWaveRobotEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'spacePlane') {\n                this.creatSpacePlaneEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'throwRobot') {\n                this.creatThrowRobotEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'heavyWaterPlane') {\n                this.creatHeavyWaterPlaneEnemy();\n                this.makeDoneFlag++;\n            }\n        }\n        this.schedule(this.makeEnemy, 2, enemyNumber);\n        this.enemyNumberBar.node.active = true; //开始游戏后敌人条可见\n    },\n    randomEnemy() {\n        let enemyFlag = null;\n        if(this.levelData.level <=5){\n            let randomNumber = Math.floor(Math.random()*ENEMYTYPE_1.length);\n            enemyFlag = ENEMYTYPE_1[randomNumber];\n        }\n        if(this.levelData.level >5 && this.levelData.level <=10){\n            let randomNumber = Math.floor(Math.random()*ENEMYTYPE_2.length);\n            enemyFlag = ENEMYTYPE_2[randomNumber];\n        }\n        if(this.levelData.level >10 ){\n            let randomNumber = Math.floor(Math.random()*ENEMYTYPE_3.length);\n            enemyFlag = ENEMYTYPE_3[randomNumber];\n        }\n        return enemyFlag;\n    },\n    creatUFOEnemy() {\n        // 创建UFO\n        let enemy = cc.instantiate(this.UFOPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        //this.makeUFOEnemyNumber++;\n    },\n    creatRocketEnemy() {\n        // 创建火箭\n        let enemy = cc.instantiate(this.rocketPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        //this.makeRocketEnemyNumber++;\n    },\n    creatWaveRobotEnemy() {\n        // 创建波动机器人\n        let enemy = cc.instantiate(this.waveRobotPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        //this.makeWaveRobotEnemyNumber++;\n    },\n    creatSpacePlaneEnemy() {\n        // 创建深空飞船\n        let enemy = cc.instantiate(this.spacePlanePrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        //this.makeSpacePlaneEnemyNumber++;\n    },\n    creatThrowRobotEnemy() {\n        // 创建投掷机器人\n        let enemy = cc.instantiate(this.throwRobotPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n    },\n    creatHeavyWaterPlaneEnemy() {\n        // 创建重水飞船\n        let enemy = cc.instantiate(this.heavyWaterPlanePrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n    },\n\n    succeedEventEmit() {\n        if (this.gameState == 1) { // gameState代表游戏状态 0：未开始，1：开始\n            this.enemyArray.map((item) => {\n                if (item.active == false) {\n                    item.parent = null;\n                    this.removeByValue(this.enemyArray, item);\n                    this.remainEnemy--; // 每移出一个敌人剩余敌人数减1\n                }\n            });\n            if ((this.makeDoneFlag == this.levelData.enemyNumber) && (this.enemyArray.length == 0)) {\n                this.node.emit(\"succeed\");\n                this.makeDoneFlag = -1;\n                this.gameState = 0;\n            }\n        }\n    },\n\n    popFailButton() {\n        //弹出失败重来按钮\n        this.failButton.active = true;\n        this.gameState = 0; // gameState == 0,表明游戏结束\n    },\n\n    updateEnemyNumberBar() {\n        // 更新敌人数量条\n        if (this.gameState == 1) {\n            let ratio = this.remainEnemy / this.levelData.enemyNumber;\n            this.enemyNumberBar.progress = ratio;\n        }\n    },\n\n    clearAllEnemy() {\n        // 停止所有计时器\n        // 将全局数组里面的敌人都销毁就好了\n        this.unscheduleAllCallbacks();\n        this.enemyArray.map((item) => {\n            item.parent = null;\n            item.destroy(); //销毁数组中的节点\n        });\n        this.enemyArray = []; //清空数组\n        this.makeDoneFlag = -1; // 将标志位设回原样\n    },\n\n    initEnemyData() {\n        // 这里必须初始化一次，否则第一次进游戏会出错\n        this.UFOInitData();\n        this.rocketInitData();\n        this.waveRobotInitData();\n        this.spacePlaneInitData();\n        this.throwRobotInitData();\n    },\n\n    // 删除数组特定元素的方法\n    removeByValue(arr, val) {\n        for (let i = 0; i < arr.length; i++) {\n            if (arr[i] == val) {\n                arr.splice(i, 1);\n                break;\n            }\n        }\n    },\n\n\n\n    /*初始化数据*/\n    UFOInitData() {\n        this.UFOObject = JSON.parse(cc.sys.localStorage.getItem(\"UFOObject\")); // 获取全局对象\n        if (this.UFOObject == null) {\n            this.UFOObject = {\n                bulletAttack: 20, // 子弹攻击力\n                impactAttack: 40, // 撞击攻击力\n                health: 100,  // 初始血量\n                bulletSpeed: 10, // 初始子弹速度\n                bulletFre: 2.5, // 子弹频率\n                coin: 100,\n            };\n            cc.sys.localStorage.setItem(\"UFOObject\", JSON.stringify(this.UFOObject));\n        } // 初始化数据\n    },\n    rocketInitData() {\n        this.rocketObject = JSON.parse(cc.sys.localStorage.getItem(\"rocketObject\")); // 获取全局对象\n        if (this.rocketObject == null) {\n            this.rocketObject = {\n                impactAttack: 40, // 撞击攻击力\n                health: 50,  // 初始血量\n                speed: 5, // 初始速度\n                coin: 200,\n            };\n            cc.sys.localStorage.setItem(\"rocketObject\", JSON.stringify(this.rocketObject));\n        } // 初始化数据\n    },\n    waveRobotInitData() {\n        this.waveRobotObject = JSON.parse(cc.sys.localStorage.getItem(\"waveRobotObject\")); // 获取全局对象\n        if (this.waveRobotObject == null) {\n            this.waveRobotObject = {\n                bulletAttack: 50, // 子弹攻击力\n                impactAttack: 120, // 撞击攻击力\n                health: 250,  // 初始血量\n                bulletSpeed: 5, // 初始子弹速度\n                bulletFre: 4, // 子弹频率\n                coin: 300,\n            };\n            cc.sys.localStorage.setItem(\"waveRobotObject\", JSON.stringify(this.waveRobotObject));\n        } // 初始化数据\n    },\n    spacePlaneInitData() {\n        this.spacePlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"spacePlaneObject\")); // 获取全局对象\n        if (this.spacePlaneObject == null) {\n            this.spacePlaneObject = {\n                bulletAttack: 200, // 子弹攻击力\n                impactAttack: 600, // 撞击攻击力\n                health: 800,  // 初始血量\n                bulletSpeed: 1, // 初始子弹速度\n                bulletFre: 4, // 子弹频率\n                coin: 700,\n            };\n            cc.sys.localStorage.setItem(\"spacePlaneObject\", JSON.stringify(this.spacePlaneObject));\n        } // 初始化数据\n    },\n    throwRobotInitData(){\n        this.throwRobotObject = JSON.parse(cc.sys.localStorage.getItem(\"throwRobotObject\")); // 获取全局对象\n        if (this.throwRobotObject == null) {\n            this.throwRobotObject = {\n                bulletAttack: 80, // 子弹攻击力\n                impactAttack: 240, // 撞击攻击力\n                health: 300,  // 初始血量\n                bulletSpeed: 12, // 初始子弹速度\n                bulletFre: 3, // 子弹频率\n                coin: 500,\n            };\n            cc.sys.localStorage.setItem(\"throwRobotObject\", JSON.stringify(this.throwRobotObject));\n        } // 初始化数据\n    },\n    heavyPlaneInitData(){\n        this.heavyPlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"heavyPlaneObject\")); // 获取全局对象\n        if (this.heavyPlaneObject == null) {\n            this.heavyPlaneObject = {\n                bulletAttack: 300, // 子弹攻击力\n                impactAttack: 600, // 撞击攻击力\n                health: 1000,  // 初始血量\n                bulletSpeed: 5, // 初始子弹速度\n                bulletFre: 3, // 子弹频率\n                coin: 1000,\n            };\n            cc.sys.localStorage.setItem(\"heavyPlaneObject\", JSON.stringify(this.heavyPlaneObject));\n        } // 初始化数据\n    },\n    /**********************/\n\n    onLoad() {\n\n    },\n\n    start() {\n\n    },\n\n    update(dt) {\n        this.succeedEventEmit();\n        this.updateEnemyNumberBar();\n        //cc.log('enemy:'+this.enemyArray.length);\n        //cc.log('flag:'+this.makeDoneFlag)\n    },\n});\n"]}