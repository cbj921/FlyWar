{"version":3,"sources":["mainWeaponScript.js"],"names":["cc","Class","extends","Component","properties","UpgradeBg","Node","attackCoinLabel","Label","speedCoinLabel","coinScript","require","popUpgradeWindow","getData","showUpgradeBg","objectName","coinData","sys","localStorage","getItem","mainPlaneData","JSON","parse","attackLabel","getChildByName","getComponent","attackNumber","speedLabel","speedNumber","string","mainWeapon","attackLevel","speedLevel","attackCost","speedCost","node","color","attackUpgradeBtn","money","Math","floor","setItem","init","updatePlaneData","speedUpgradeBtn","properyName","stringify","showIcon","active","hideIcon","position","v2","hideUpgradeBg","onLoad"],"mappings":"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","file":"mainWeaponScript.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI脚本","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        UpgradeBg: cc.Node,\n        attackCoinLabel: cc.Label,\n        speedCoinLabel: cc.Label,\n\n        coinScript:require(\"coinScript\"),\n    },\n\n    popUpgradeWindow() {\n        // 更新各种数值\n        this.getData(\"mainPlaneObject\");\n        // 弹出升级窗口\n        this.showUpgradeBg();\n    },\n\n    /**\n     * @description: 更新数据\n     * @param {string} objectName:传入需要获取到数据的对象名\n     * @return: \n     */\n    getData(objectName) {\n        this.coinData = cc.sys.localStorage.getItem('coinData');\n        this.mainPlaneData = JSON.parse(cc.sys.localStorage.getItem(objectName));\n\n        let attackLabel = this.UpgradeBg.getChildByName(\"attackLabel\").getComponent(cc.Label);\n        let attackNumber = this.UpgradeBg.getChildByName(\"attackNumber\").getComponent(cc.Label);\n\n        let speedLabel = this.UpgradeBg.getChildByName(\"speedLabel\").getComponent(cc.Label);\n        let speedNumber = this.UpgradeBg.getChildByName(\"speedNumber\").getComponent(cc.Label);\n\n        attackLabel.string = `攻击力 [Lv${this.mainPlaneData.mainWeapon.attackLevel}]`;\n        speedLabel.string = `速度值 [Lv${this.mainPlaneData.mainWeapon.speedLevel}]`;\n\n        attackNumber.string = this.mainPlaneData.mainWeapon.attackNumber;\n        speedNumber.string = this.mainPlaneData.mainWeapon.speedNumber/10; // 除10是因为用小数会有精度问题，所以speed初始为30，而不是3\n\n        this.attackCoinLabel.string = this.mainPlaneData.mainWeapon.attackCost;\n        this.speedCoinLabel.string = this.mainPlaneData.mainWeapon.speedCost;\n\n        // 如果金钱比升级费用少字体就为红色\n        if (this.coinData >= this.mainPlaneData.mainWeapon.attackCost) {\n            this.attackCoinLabel.node.color = cc.color(255, 255, 255, 255);\n        } else {\n            this.attackCoinLabel.node.color = cc.color(255, 0, 0, 255);\n        }\n        if (this.coinData >= this.mainPlaneData.mainWeapon.speedCost) {\n            this.speedCoinLabel.node.color = cc.color(255, 255, 255, 255);\n        } else {\n            this.speedCoinLabel.node.color = cc.color(255, 0, 0, 255);\n        }\n\n    },\n\n    // 这个是按键用的函数\n    attackUpgradeBtn() {\n        // 点击攻击力升级按钮\n        let money = Math.floor(this.coinData - this.mainPlaneData.mainWeapon.attackCost);// 不能出现小数\n        if (money >= 0) {\n            // 更新金钱\n            this.coinData = money;\n            cc.sys.localStorage.setItem(\"coinData\", this.coinData);//把钱存储\n            this.coinScript.init(); // 更新金钱标签\n            // 更新战机数值\n            this.updatePlaneData('attack');\n        }\n    },\n    speedUpgradeBtn() {\n        // 点击攻速升级按钮\n        let money = Math.floor(this.coinData - this.mainPlaneData.mainWeapon.speedCost);// 不能出现小数\n        if (money >= 0) {\n            // 更新金钱\n            this.coinData = money;\n            cc.sys.localStorage.setItem(\"coinData\", this.coinData);//把钱存储\n            this.coinScript.init(); // 更新金钱标签\n            // 更新战机数值\n            this.updatePlaneData('speed');\n        }\n    },\n\n    // 更新飞机数据\n    updatePlaneData(properyName) {\n        // 攻击\n        if(properyName == 'attack'){\n            this.mainPlaneData.mainWeapon.attackLevel++;\n            this.mainPlaneData.mainWeapon.attackNumber += 5; //每升一级加5\n            if (this.mainPlaneData.mainWeapon.attackLevel % 10 == 1) {\n                // 每升级10次额外加50\n                this.mainPlaneData.mainWeapon.attackNumber +=50;\n            }\n            this.mainPlaneData.mainWeapon.attackCost = Math.floor(this.mainPlaneData.mainWeapon.attackCost*2); //每次升级费用翻2倍 \n            cc.sys.localStorage.setItem(\"mainPlaneObject\",JSON.stringify(this.mainPlaneData));\n            this.getData(\"mainPlaneObject\"); // 更新数值\n        }\n        //  速度\n        if(properyName == 'speed'){\n            this.mainPlaneData.mainWeapon.speedLevel++;\n            this.mainPlaneData.mainWeapon.speedNumber += 2; //每升一级加2\n            if (this.mainPlaneData.mainWeapon.speedLevel % 10 == 1) {\n                // 每升级10次额外加3\n                this.mainPlaneData.mainWeapon.speedNumber +=30;\n            }\n\n            this.mainPlaneData.mainWeapon.speedCost = Math.floor(this.mainPlaneData.mainWeapon.speedCost*2); //每次升级费用翻2倍 \n\n            cc.sys.localStorage.setItem(\"mainPlaneObject\",JSON.stringify(this.mainPlaneData));\n            this.getData(\"mainPlaneObject\"); // 更新数值\n        }\n    },\n\n\n    showIcon(){\n        this.node.active = true;\n    },\n    hideIcon(){\n        this.node.active = false;\n    },\n\n    showUpgradeBg(){\n        this.UpgradeBg.position = cc.v2(544, 416);\n    },\n    hideUpgradeBg(){\n        this.UpgradeBg.position = cc.v2(4000, 416); // 随意设的坐标，只要不让他显示在可见区域就行，不用node的active是因为active对性能影响较大\n    },\n\n    onLoad() {\n\n    },\n\n    // update (dt) {},\n});\n"]}