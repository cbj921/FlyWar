{"version":3,"sources":["strengthScript.js"],"names":["cc","Class","extends","Component","properties","init","label","node","getChildByName","getComponent","Label","strengthData","sys","localStorage","getItem","setItem","string","showIcon","active","color","hideIcon","failStrength","consumeStrength","strengthSelfGrow","strengthGrow","schedule","opengetStrength","lastTime","Date","now","nowTime","deltaTime","Math","floor","onLoad","on"],"mappings":"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","file":"strengthScript.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI脚本","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n    },\n\n    init(){\n        this.label = this.node.getChildByName(\"strengthNumber\").getComponent(cc.Label); // 获取标签组件\n        this.strengthData = cc.sys.localStorage.getItem(\"strengthData\"); // 获取体力的数据\n        if(this.strengthData == null){\n            // 如果获取不到体力的数据说明为第一次游戏\n            this.strengthData = 100; // 初始体力为 100\n            cc.sys.localStorage.setItem(\"strengthData\",this.strengthData);\n        }\n        this.label.string = this.strengthData + '/' + \"100\";\n\n        this.showIcon();\n        return this.strengthData;\n    },\n\n    showIcon(){\n        this.node.active = true;\n        if(this.strengthData<5){\n            this.label.node.color = cc.color(255,0,0,255);// 体力不足字体颜色为红色\n        }\n    },\n    hideIcon(){\n        this.node.active = false;\n    },\n\n    // 因为体力只有失败才扣，所以只要写失败的时候就行了\n    failStrength() {\n        let consumeStrength = 5;\n        let strengthData = cc.sys.localStorage.getItem(\"strengthData\");\n        strengthData = strengthData-consumeStrength;\n        cc.sys.localStorage.setItem('strengthData', strengthData);\n    },\n\n    strengthSelfGrow(){\n        // 体力自增长\n        this.strengthGrow = ()=>{\n            let strengthData = cc.sys.localStorage.getItem(\"strengthData\");\n            strengthData = strengthData-0+5 ; // 这里用了一个JS数据转换技巧，先减0，将字符串变成数字类型\n            if(strengthData>100){\n                strengthData = 100;\n            }\n            this.label.string = strengthData + '/' + \"100\";\n            cc.sys.localStorage.setItem('strengthData', strengthData);\n            this.init();\n        }\n        this.schedule(this.strengthGrow,300); // 300秒执行一次，即五分钟恢复一次体力\n    },\n\n    opengetStrength(){\n        //关闭游戏再打开后回复体力\n        let label = this.node.getChildByName(\"strengthNumber\").getComponent(cc.Label); // 获取标签组件\n        let lastTime = cc.sys.localStorage.getItem(\"lastTime\");\n        if(lastTime == null){\n            lastTime = Date.now(); // 获取时间戳\n            cc.sys.localStorage.setItem(\"lastTime\",lastTime);\n        }\n        let nowTime = Date.now();\n        let deltaTime = Math.floor((nowTime - lastTime)/1000/60/5); // 获得相差的时间(单位 /5分钟)\n        let strengthData = cc.sys.localStorage.getItem(\"strengthData\");\n        strengthData = strengthData - 0 + deltaTime*5; // 这里用了一个JS数据转换技巧，先减0，将字符串变成数字类型\n\n        if(strengthData > 100){\n            strengthData = 100;\n        }\n        label.string =  strengthData + '/' + \"100\";\n\n        cc.sys.localStorage.setItem('strengthData', strengthData); // 存储体力数据\n        cc.sys.localStorage.setItem('lastTime', nowTime);\n        this.init();\n    },\n\n    onLoad () {\n        this.node.on(\"fail\",this.failStrength);// 监听失败事件\n    },\n\n\n\n    // update (dt) {},\n});\n"]}