{"version":3,"sources":["subWeaponScript.js"],"names":["cc","Class","extends","Component","properties","UpgradeBg","Node","attackCoinLabel","Label","laserButton","Button","grainButton","coinScript","require","initData","flag","coinData","sys","localStorage","getItem","mainPlaneData","JSON","parse","subWeapon","gunNameLabel","getChildByName","getComponent","attackLevelLabel","attackNumberLabel","popUpgradeWindow","setGrainData","setLaserData","showUpgradeBg","string","grainGun","attackLevel","attackNumber","attackCost","node","color","laserGun","updateSubWeaponData","properyName","Math","floor","setItem","stringify","clickGrainButton","clickLaserButton","attackUpgradeBtn","money","init","showIcon","active","hideIcon","position","v2","hideUpgradeBg"],"mappings":"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","file":"subWeaponScript.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI脚本","sourcesContent":["\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        UpgradeBg: cc.Node,\n        attackCoinLabel: cc.Label,\n\n        laserButton: cc.Button,\n        grainButton: cc.Button,\n\n        coinScript: require(\"coinScript\"),\n    },\n\n    initData() {\n        this.flag = 0;\n        this.coinData = cc.sys.localStorage.getItem('coinData'); // 获取金币数据\n        this.mainPlaneData = JSON.parse(cc.sys.localStorage.getItem(\"mainPlaneObject\")); // 获取飞机对象\n        this.subWeapon = this.mainPlaneData.subWeapon;\n        this.gunNameLabel = this.UpgradeBg.getChildByName(\"gunName\").getComponent(cc.Label);\n        this.attackLevelLabel = this.UpgradeBg.getChildByName(\"attackLabel\").getComponent(cc.Label);\n        this.attackNumberLabel = this.UpgradeBg.getChildByName(\"attackNumber\").getComponent(cc.Label);\n    },\n\n    popUpgradeWindow() {\n        // 更新各种数值\n        if(this.flag == 0){\n            this.setGrainData();\n        }\n        if(this.flag == 1){\n            this.setLaserData();\n        }\n        // 弹出升级窗口\n        this.showUpgradeBg();\n    },\n\n    setGrainData(){\n        // 设置粒子枪数据\n        this.gunNameLabel.string = '粒子枪';\n        this.attackLevelLabel.string = `攻击力 [Lv${this.subWeapon.grainGun.attackLevel}]`;\n        this.attackNumberLabel.string = this.subWeapon.grainGun.attackNumber;\n        this.attackCoinLabel.string = this.subWeapon.grainGun.attackCost;\n        if (this.coinData >= this.subWeapon.grainGun.attackCost) {\n            this.attackCoinLabel.node.color = cc.color(255, 255, 255, 255);\n        } else {\n            this.attackCoinLabel.node.color = cc.color(255, 0, 0, 255);\n        }\n    },\n\n    setLaserData(){\n        // 设置镭射枪数据\n        this.gunNameLabel.string = '镭射枪';\n        this.attackLevelLabel.string = `攻击力 [Lv${this.subWeapon.laserGun.attackLevel}]`;\n        this.attackNumberLabel.string = this.subWeapon.laserGun.attackNumber;\n        this.attackCoinLabel.string = this.subWeapon.laserGun.attackCost;\n        if (this.coinData >= this.subWeapon.laserGun.attackCost) {\n            this.attackCoinLabel.node.color = cc.color(255, 255, 255, 255);\n        } else {\n            this.attackCoinLabel.node.color = cc.color(255, 0, 0, 255);\n        }\n    },\n\n    //更新副武器数据\n    updateSubWeaponData(properyName) {\n        // 粒子枪攻击\n        if(properyName == 'grain'){\n            this.subWeapon.grainGun.attackLevel++;\n            this.subWeapon.grainGun.attackNumber += 3; //每升一级加3\n            if (this.subWeapon.grainGun.attackLevel % 5 == 1) {\n                // 每升级5次额外加10\n                this.subWeapon.grainGun.attackNumber +=10;\n            }\n            this.subWeapon.grainGun.attackCost = Math.floor(this.subWeapon.grainGun.attackCost*2); //每次升级费用翻2倍\n            this.setGrainData(); //更新数据\n        }\n        //  镭射枪攻击\n        if(properyName == 'laser'){\n            this.subWeapon.laserGun.attackLevel++;\n            this.subWeapon.laserGun.attackNumber += 15; //每升一级加15\n            if (this.subWeapon.laserGun.attackLevel % 5 == 1) {\n                // 每升级5次额外加50\n                this.subWeapon.laserGun.attackNumber +=50;\n            }\n            this.subWeapon.laserGun.attackCost = Math.floor(this.subWeapon.laserGun.attackCost*2); //每次升级费用翻2倍 \n            this.setLaserData(); //更新数据\n        }\n        this.mainPlaneData.subWeapon = this.subWeapon;\n        cc.sys.localStorage.setItem(\"mainPlaneObject\",JSON.stringify(this.mainPlaneData));\n    },\n\n\n    // 按键函数\n    clickGrainButton(){\n        // 点击粒子枪的按钮\n        this.flag = 0;\n        this.popUpgradeWindow();\n    },\n    clickLaserButton(){\n        this.flag = 1;\n        this.popUpgradeWindow();\n    },\n    // 点击升级按钮\n    attackUpgradeBtn() {\n        if(this.flag == 0){\n            // 粒子枪升级\n            let money = Math.floor(this.coinData - this.subWeapon.grainGun.attackCost);// 不能出现小数\n            if (money >= 0) {\n                // 更新金钱\n                this.coinData = money;\n                cc.sys.localStorage.setItem(\"coinData\", this.coinData);//把钱存储\n                this.coinScript.init(); // 更新金钱标签\n                // 更新副武器数值\n                this.updateSubWeaponData('grain');\n            }\n        }\n        if(this.flag == 1){\n            // 镭射枪升级\n            let money = Math.floor(this.coinData - this.subWeapon.laserGun.attackCost);// 不能出现小数\n            if (money >= 0) {\n                // 更新金钱\n                this.coinData = money;\n                cc.sys.localStorage.setItem(\"coinData\", this.coinData);//把钱存储\n                this.coinScript.init(); // 更新金钱标签\n                // 更新副武器数值\n                this.updateSubWeaponData('laser');\n            }\n        }\n    },\n\n\n    // onLoad () {},\n\n    showIcon() {\n        this.node.active = true;\n    },\n    hideIcon() {\n        this.node.active = false;\n    },\n\n    showUpgradeBg() {\n        this.UpgradeBg.position = cc.v2(544, 416);\n    },\n    hideUpgradeBg() {\n        this.UpgradeBg.position = cc.v2(4000, 416); // 随意设的坐标，只要不让他显示在可见区域就行，不用node的active是因为active对性能影响较大\n    },\n\n    // update (dt) {},\n});\n"]}