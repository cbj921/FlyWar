{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\mainPlane.js"],"names":["cc","Class","extends","Component","properties","endPosY","moveSpeed","moveLimit","startHealth","startBulletSpeed","startAttack","startPower","healthBar","ProgressBar","bullet","Prefab","strengthLabel","Node","init","node","setPosition","v2","Canvas","parent","initData","mainPlaneObject","JSON","parse","sys","localStorage","getItem","protect","level","number","cost","mainWeapon","attackNumber","speedNumber","attackLevel","speedLevel","attackCost","speedCost","power","subWeapon","grainGun","powerCost","laserGun","setItem","stringify","varHealth","startFly","flyAction","moveTo","easing","easeCubicActionOut","runAction","initHealthBar","registerPlaneControlEvent","creatBullet","getAllEnemyData","isMoving","startTouchBack","event","touches","getTouches","touchLoc","getLocation","moveToPos","convertToNodeSpaceAR","moveTouchBack","endTouchBack","on","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","updatePlanePos","dt","oldPos","position","direction","sub","normalize","distance","mag","add","mul","progress","updateHealthBar","ratio","failEvent","emit","unschedule","bulletCallback","UFOData","rocketData","waveRobotData","spacePlaneData","bulletInit","bulletPrefab","bulletPool","NodePool","initCount","i","instantiate","put","size","get","x","y","bulletAction","schedule","bulletNode","duration","moveAction","finished","callFunc","destroy","shootAction","sequence","onCollisionEnter","other","self","tag","impactAttack","bulletAttack","update","onLoad"],"mappings":"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","file":"mainPlane.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\n//每次升级才要存储新的数据，其余时候只要读取就好 \n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        endPosY: 0,\n        moveSpeed: 0,\n        moveLimit: 0, //移动的临界点\n\n        startHealth: 0,\n        startBulletSpeed: 0,\n        startAttack: 0,\n        startPower: 0,\n        healthBar: cc.ProgressBar,\n        bullet: [cc.Prefab],\n        strengthLabel:cc.Node,\n\n        //enemyScript:require('enemyControl'),\n    },\n\n    init() {\n        this.node.setPosition(cc.v2(0, -1760));\n        this.Canvas = this.node.parent;\n    },\n\n    initData() {\n        this.mainPlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"mainPlaneObject\")); // 获取全局对象\n        if (this.mainPlaneObject == null) {\n            this.mainPlaneObject = {\n                protect: {\n                    level: 1,\n                    number: this.startHealth,\n                    cost: 100,\n                },\n                mainWeapon: {\n                    attackNumber: this.startAttack,\n                    speedNumber: this.startBulletSpeed,\n                    attackLevel: 1,\n                    speedLevel: 1,\n                    attackCost: 100,\n                    speedCost: 100,\n                },\n                power: {\n                    level: 1,\n                    number: this.startPower,\n                    cost: 150,\n                },\n                subWeapon:{\n                    grainGun: {\n                        attackNumber: 2,\n                        speedNumber: 5,\n                        attackLevel: 1,\n                        attackCost: 100,\n                        powerCost:10,\n                    },\n                    laserGun: {\n                        attackNumber: 20,\n                        speedNumber: 1,\n                        attackLevel: 1,\n                        attackCost: 200,\n                        powerCost:20,\n                    },\n                },\n            };\n            cc.sys.localStorage.setItem(\"mainPlaneObject\", JSON.stringify(this.mainPlaneObject));\n            this.mainPlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"mainPlaneObject\")); // 获取全局对象\n        } // 初始化数据\n        this.varHealth = this.mainPlaneObject.protect.number; // 因为血量在游戏的时候会一直变化，所以用一个中间值来在游戏中进行改变\n    },\n\n    startFly() {\n        // 飞到指定位置\n        let flyAction = cc.moveTo(1, cc.v2(0, this.endPosY)).easing(cc.easeCubicActionOut());\n        this.node.runAction(flyAction);\n        this.initHealthBar();\n        this.registerPlaneControlEvent();\n        this.creatBullet();\n        this.getAllEnemyData(); // 获取所有敌人数据\n    },\n\n    registerPlaneControlEvent() {\n        this.isMoving = false; // 记录单机事件是否在移动\n\n        this.startTouchBack = (event) => {\n            // 回调函数\n            let touches = event.getTouches();\n            let touchLoc = touches[0].getLocation(); // 获取到第一个触摸点的坐标\n            this.isMoving = true; // 正在移动标志位\n            this.moveToPos = this.Canvas.convertToNodeSpaceAR(touchLoc);\n        }\n        this.moveTouchBack = (event) => {\n            let touches = event.getTouches();\n            let touchLoc = touches[0].getLocation();\n            this.moveToPos = this.Canvas.convertToNodeSpaceAR(touchLoc);\n        }\n        this.endTouchBack = (event) => {\n            this.isMoving = false;\n        }\n\n        this.Canvas.on(cc.Node.EventType.TOUCH_START, this.startTouchBack, this.node);\n        this.Canvas.on(cc.Node.EventType.TOUCH_MOVE, this.moveTouchBack, this.node);\n        this.Canvas.on(cc.Node.EventType.TOUCH_END, this.endTouchBack, this.node);\n    },\n\n    updatePlanePos(dt) {\n        if (!this.isMoving) {\n            return;\n        }\n        let oldPos = this.node.position;\n        let direction = this.moveToPos.sub(oldPos).normalize();// 获得移动方向\n        let distance = this.moveToPos.sub(oldPos).mag(); // 获得向量的长度\n        if (distance > this.moveLimit) {\n            this.node.setPosition(oldPos.add(direction.mul(this.moveSpeed * dt)));\n        }\n        // 偏移方向\n\n    },\n\n    initHealthBar() {\n        // 更新血条，让血回满\n        // 初始化血量\n        this.varHealth = this.mainPlaneObject.protect.number;\n        this.healthBar.progress = 1;\n    },\n    updateHealthBar() {\n        let ratio = this.varHealth / this.mainPlaneObject.protect.number;\n        this.healthBar.progress = ratio;\n        if (ratio == 0) {\n            this.failEvent();\n        }\n    },\n    failEvent() {\n        this.initHealthBar();// 让血回满，就不会一直发射事件\n        this.strengthLabel.emit('fail');// 给strengthLabel发送失败事件\n        this.Canvas.emit(\"fail\"); // 给canvas 发送失败事件\n        this.unschedule(this.bulletCallback);// 关闭子弹发射\n    },\n\n    getAllEnemyData() {\n        // 获取到所有敌人数据\n        this.UFOData = JSON.parse(cc.sys.localStorage.getItem(\"UFOObject\"));\n        this.rocketData = JSON.parse(cc.sys.localStorage.getItem(\"rocketObject\"));\n        this.waveRobotData = JSON.parse(cc.sys.localStorage.getItem(\"waveRobotObject\"));\n        this.spacePlaneData = JSON.parse(cc.sys.localStorage.getItem(\"spacePlaneObject\"));\n        //获取到其他敌人\n        //。。。。\n\n        //cc.log(this.UFOData);\n    },\n\n    bulletInit(bulletPrefab) {\n        this.bulletPool = new cc.NodePool();\n        let initCount = 15;\n        for (let i = 0; i < initCount; i++) {\n            let bullet = cc.instantiate(bulletPrefab);\n            this.bulletPool.put(bullet);\n        }\n    },\n\n    creatBullet() {\n        this.bulletCallback = () => {\n            let bullet = null;\n            if (this.bulletPool.size() > 0) { // 通过 size 接口判断对象池中是否有空闲的对象\n                bullet = this.bulletPool.get();\n            } else { // 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建\n                bullet = cc.instantiate(this.bullet[0]);\n            }\n            bullet.parent = this.node.parent; // 将生成的子弹加入canvas节点\n            bullet.position = cc.v2(this.node.x, this.node.y);\n            this.bulletAction(bullet);\n        };\n        this.schedule(this.bulletCallback, 1 / (this.mainPlaneObject.mainWeapon.speedNumber / 10));//\n\n    },\n\n    bulletAction(bulletNode) {\n        let duration = (1100 - this.node.y) / 1200;  // 计算时间，这样不管在哪个位置发射子弹速度都一样了\n        this.moveAction = cc.moveTo(duration, cc.v2(this.node.x, 1100)); // 初始位置是0\n        this.finished = cc.callFunc(() => {\n            if (this.bulletPool == null) {\n                bulletNode.destroy();  //因为飞机没了后，对象池也没了,所以把剩下的子弹销毁\n            } else {\n                this.bulletPool.put(bulletNode);\n            }\n        });\n        let shootAction = cc.sequence(this.moveAction, this.finished);\n        bulletNode.runAction(shootAction);\n    },\n\n    /**\n* 当碰撞产生的时候调用\n* @param  {Collider} other 产生碰撞的另一个碰撞组件\n* @param  {Collider} self  产生碰撞的自身的碰撞组件\n*/\n    onCollisionEnter(other, self) {\n        if (other.tag == 0) {\n            //tag==0表示碰到飞碟\n            this.varHealth = this.varHealth - this.UFOData.impactAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n        if (other.tag == 1) {\n            //tag==1表示碰到飞碟子弹\n            this.varHealth = this.varHealth - this.UFOData.bulletAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n        if (other.tag == 2) {\n            //tag==2表示碰到火箭\n            this.varHealth = this.varHealth - this.rocketData.impactAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n        if (other.tag == 3) {\n            //tag==3表示碰到波动机器人\n            this.varHealth = this.varHealth - this.waveRobotData.impactAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n        if (other.tag == 4) {\n            //tag==4表示碰到波动机器人子弹\n            this.varHealth = this.varHealth - this.waveRobotData.bulletAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n        if (other.tag == 5) {\n            //tag==5表示碰到深空飞机\n            this.varHealth = this.varHealth - this.spacePlaneData.impactAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n        if (other.tag == 6) {\n            //tag==6表示碰到深空飞机子弹\n            this.varHealth = this.varHealth - this.spacePlaneData.bulletAttack;\n            if (this.varHealth < 0) {\n                this.varHealth = 0;\n            }\n        }\n\n\n    },\n\n    update(dt) {\n        this.updatePlanePos(dt);// 更新飞机位置\n        this.updateHealthBar();// 更新血条\n    },\n\n    onLoad() {\n        this.bulletInit(this.bullet[0]);\n    },\n\n\n});\n"]}