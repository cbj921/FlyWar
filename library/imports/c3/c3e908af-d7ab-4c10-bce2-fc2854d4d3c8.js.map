{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\enemyPrefab/assets\\Script\\enemyPrefab\\rocket.js"],"names":["cc","Class","extends","Component","properties","startImpactAttack","startHealth","startSpeed","moveVenticalDistance","healthBar","ProgressBar","initData","rocketObject","JSON","parse","sys","localStorage","getItem","impactAttack","health","speed","coin","setItem","stringify","mainPlaneData","coinData","moveAction","randomPosition","moveTo","v2","node","x","backAction","callFunc","runAction","sequence","max","min","posY","posX","Math","floor","random","setPosition","initHealthBar","varHealth","progress","updateHealthBar","ratio","parent","getCoin","destroy","onCollisionEnter","other","self","tag","mainWeapon","attackNumber","subWeapon","laserGun","grainGun","onLoad","update","dt"],"mappings":"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","file":"rocket.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\enemyPrefab","sourcesContent":["\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        startImpactAttack: 0, // 撞击攻击力\n        startHealth: 0,  // 初始血量\n        startSpeed: 0, // 初始速度\n\n        moveVenticalDistance: 0,\n        healthBar: cc.ProgressBar,\n    },\n\n    initData() {\n        this.rocketObject = JSON.parse(cc.sys.localStorage.getItem(\"rocketObject\")); // 获取全局对象\n        if (this.rocketObject == null) {\n            this.rocketObject = {\n                impactAttack: this.startImpactAttack, // 撞击攻击力\n                health: this.startHealth,  // 初始血量\n                speed: this.startSpeed, // 初始速度\n                coin:200,\n            };\n            cc.sys.localStorage.setItem(\"rocketObject\", JSON.stringify(this.rocketObject));\n            this.rocketObject = JSON.parse(cc.sys.localStorage.getItem(\"rocketObject\")); // 获取全局对象\n        } // 初始化数据\n\n        this.mainPlaneData = JSON.parse(cc.sys.localStorage.getItem(\"mainPlaneObject\"));// 获取飞机数据\n        this.coinData = cc.sys.localStorage.getItem('coinData');// 得到金币数据\n    },\n\n    moveAction() {\n        this.randomPosition(380, -400); // 不要问我为什么是这个数值，我测试出来的\n        let moveAction = cc.moveTo(this.rocketObject.speed, cc.v2(this.node.x, this.moveVenticalDistance));  // 移动到（this.node.x，-1100）的位置\n\n        this.backAction = cc.callFunc(()=>{\n            // 到底部回到顶部回调函数\n            this.randomPosition(380, -400); \n            moveAction = cc.moveTo(this.rocketObject.speed, cc.v2(this.node.x, this.moveVenticalDistance));// 这里是因为要重新设置 x 的坐标\n            this.node.runAction(cc.sequence(moveAction,this.backAction));\n        });\n\n        this.node.runAction(cc.sequence(moveAction,this.backAction));\n    },\n\n    randomPosition(max, min) {\n        //随机出现位置\n        let posY = 1020; // 起始纵坐标固定\n        let posX = Math.floor(Math.random() * (max - min)) + min; // \n        this.node.setPosition(posX, posY);\n    },\n\n    // 血条\n    initHealthBar(){\n        // 更新血条，让血回满\n        // 初始化血量\n        this.varHealth=this.rocketObject.health;\n        this.healthBar.progress = 1;\n    },\n\n    updateHealthBar(){\n        let ratio = this.varHealth/this.rocketObject.health;\n        this.healthBar.progress = ratio;\n        if(ratio == 0){\n            this.node.parent = null;\n            this.getCoin();\n            this.node.destroy();\n        }\n    },\n\n    getCoin(){\n        // 击杀后得到金币\n        this.coinData = this.coinData-0 + this.rocketObject.coin;\n        cc.sys.localStorage.setItem('coinData',this.coinData); \n    },\n\n    // 火箭没有子弹\n    onCollisionEnter(other, self) {\n        // 敌机的碰撞tag暂时为，飞机：0，普通子弹：1\n        if(other.tag == 0){\n            this.node.destroy();\n        }\n        if(other.tag == 1){\n            //被子弹射中\n            this.varHealth -= this.mainPlaneData.mainWeapon.attackNumber;\n            if(this.varHealth<0){\n                this.varHealth =0;\n            }\n        }\n        if(other.tag == 2){\n            // 被镭射激光射中\n            this.varHealth -= this.mainPlaneData.subWeapon.laserGun.attackNumber;\n            if(this.varHealth<0){\n                this.varHealth =0;\n            }\n        }\n        if(other.tag == 3){\n            // 被粒子枪粒子击中\n            this.varHealth -= this.mainPlaneData.subWeapon.grainGun.attackNumber;\n            if(this.varHealth<0){\n                this.varHealth =0;\n            }\n        }\n    },\n\n    onLoad () {\n        this.initData();\n        this.initHealthBar();\n        this.moveAction();\n    },\n\n    update (dt) {\n        this.updateHealthBar();\n    },\n});\n"]}