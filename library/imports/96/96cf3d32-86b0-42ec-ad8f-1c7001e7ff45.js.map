{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\enemyPrefab/assets\\Script\\enemyPrefab\\heavyPlane.js"],"names":["cc","Class","extends","Component","properties","startBulletAttack","startImpactAttack","startHealth","startBulletSpeed","bulletFre","moveVenticalDuration","moveVenticalDistance","healthBar","ProgressBar","bulletPrefab","Prefab","initData","heavyPlaneObject","JSON","parse","sys","localStorage","getItem","bulletAttack","impactAttack","health","bulletSpeed","coin","setItem","stringify","mainPlaneData","coinData","moveAction","randomPosition","moveTo","v2","node","x","backAction","callFunc","runAction","sequence","max","min","posY","posX","Math","floor","random","setPosition","initHealthBar","varHealth","progress","updateHealthBar","ratio","parent","getCoin","destroy","onCollisionEnter","other","self","tag","mainWeapon","attackNumber","subWeapon","laserGun","grainGun","onLoad","start","update","dt"],"mappings":"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","file":"heavyPlane.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\enemyPrefab","sourcesContent":["\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        startBulletAttack: 0, // 子弹攻击力\r\n        startImpactAttack: 0, // 撞击攻击力\r\n        startHealth: 0,  // 初始血量\r\n        startBulletSpeed: 0, // 初始子弹速度\r\n        bulletFre: 0, // 子弹频率\r\n\r\n        moveVenticalDuration: 0,\r\n        moveVenticalDistance: 0,\r\n\r\n        healthBar: cc.ProgressBar,\r\n        bulletPrefab:cc.Prefab,\r\n    },\r\n\r\n    initData() {\r\n        this.heavyPlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"heavyPlaneObject\")); // 获取全局对象\r\n        if (this.heavyPlaneObject == null) {\r\n            this.heavyPlaneObject = {\r\n                bulletAttack: this.startBulletAttack, // 子弹攻击力\r\n                impactAttack: this.startImpactAttack, // 撞击攻击力\r\n                health: this.startHealth,  // 初始血量\r\n                bulletSpeed: this.startBulletSpeed, // 初始子弹速度\r\n                bulletFre: this.bulletFre, // 子弹频率\r\n                coin:1000,\r\n            };\r\n            cc.sys.localStorage.setItem(\"heavyPlaneObject\", JSON.stringify(this.heavyPlaneObject));\r\n            this.heavyPlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"heavyPlaneObject\")); // 获取全局对象\r\n        } // 初始化数据\r\n\r\n        this.mainPlaneData = JSON.parse(cc.sys.localStorage.getItem(\"mainPlaneObject\"));// 获取飞机数据\r\n        this.coinData = cc.sys.localStorage.getItem('coinData');// 得到金币数据\r\n    },\r\n\r\n    moveAction() {\r\n        this.randomPosition(380, -400); // 不要问我为什么是这个数值，我测试出来的\r\n\r\n        let moveAction = cc.moveTo(this.moveVenticalDuration, cc.v2(this.node.x, this.moveVenticalDistance));  // 移动到（0，-1100）的位置\r\n\r\n        this.backAction = cc.callFunc(()=>{\r\n            // 到底部回到顶部回调函数\r\n            this.randomPosition(380, -400); \r\n            moveAction = cc.moveTo(this.moveVenticalDuration, cc.v2(this.node.x, this.moveVenticalDistance));  // 重新设置 x 值\r\n            this.node.runAction(cc.sequence(moveAction,this.backAction));\r\n        });\r\n\r\n        this.node.runAction(cc.sequence(moveAction,this.backAction));\r\n    },\r\n    randomPosition(max, min) {\r\n        //随机出现位置\r\n        let posY = 1020; // 起始纵坐标固定\r\n        let posX = Math.floor(Math.random() * (max - min)) + min; // \r\n        this.node.setPosition(posX, posY);\r\n    },\r\n\r\n    initHealthBar(){\r\n        // 更新血条，让血回满\r\n        // 初始化血量\r\n        this.varHealth=this.heavyPlaneObject.health;\r\n        this.healthBar.progress = 1;\r\n    },\r\n\r\n    updateHealthBar(){\r\n        let ratio = this.varHealth/this.heavyPlaneObject.health;\r\n        this.healthBar.progress = ratio;\r\n        if(ratio == 0){\r\n            this.node.parent = null;\r\n            this.getCoin();\r\n            this.node.destroy();\r\n        }\r\n    },\r\n    getCoin(){\r\n        // 击杀后得到金币\r\n        this.coinData = this.coinData-0 + this.heavyPlaneObject.coin;\r\n        cc.sys.localStorage.setItem('coinData',this.coinData); \r\n    },\r\n\r\n    /**\r\n    * 当碰撞产生的时候调用\r\n    * @param  {Collider} other 产生碰撞的另一个碰撞组件\r\n    * @param  {Collider} self  产生碰撞的自身的碰撞组件\r\n    */\r\n   onCollisionEnter(other, self) {\r\n    // 敌机的碰撞tag暂时为，飞机：0，普通子弹：1\r\n    if(other.tag == 0){\r\n        this.node.destroy();\r\n    }\r\n    if(other.tag == 1){\r\n        //被子弹射中\r\n        this.varHealth -= this.mainPlaneData.mainWeapon.attackNumber;\r\n        if(this.varHealth<0){\r\n            this.varHealth =0;\r\n        }\r\n    }\r\n    if(other.tag == 2){\r\n        // 被镭射激光射中\r\n        this.varHealth -= this.mainPlaneData.subWeapon.laserGun.attackNumber;\r\n        if(this.varHealth<0){\r\n            this.varHealth =0;\r\n        }\r\n    }\r\n    if(other.tag == 3){\r\n        // 被粒子枪粒子击中\r\n        this.varHealth -= this.mainPlaneData.subWeapon.grainGun.attackNumber;\r\n        if(this.varHealth<0){\r\n            this.varHealth =0;\r\n        }\r\n    }\r\n},\r\n\r\n    onLoad () {\r\n        this.initData();\r\n        this.initHealthBar();\r\n        this.moveAction();\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        this.updateHealthBar();\r\n    },\r\n});\r\n"]}