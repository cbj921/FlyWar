{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\enemyControl.js"],"names":["ENEMYTYPE_1","ENEMYTYPE_2","ENEMYTYPE_3","cc","Class","extends","Component","properties","UFOPrefab","Prefab","rocketPrefab","waveRobotPrefab","throwRobotPrefab","spacePlanePrefab","heavyWaterPlanePrefab","enemyNumberBar","ProgressBar","failButton","Node","initLevelData","levelData","JSON","parse","sys","localStorage","getItem","init","makeDoneFlag","enemyArray","active","node","startGame","gameState","enemyNumber","remainEnemy","makeEnemy","enemyFlag","randomEnemy","creatUFOEnemy","creatRocketEnemy","creatWaveRobotEnemy","creatSpacePlaneEnemy","creatThrowRobotEnemy","creatHeavyWaterPlaneEnemy","log","schedule","level","randomNumber","Math","floor","random","length","enemy","instantiate","parent","push","makeUFOEnemyNumber","makeRocketEnemyNumber","makeWaveRobotEnemyNumber","makeSpacePlaneEnemyNumber","succeedEventEmit","map","item","removeByValue","emit","popFailButton","updateEnemyNumberBar","ratio","progress","clearAllEnemy","unscheduleAllCallbacks","destroy","initEnemyData","UFOInitData","rocketInitData","waveRobotInitData","spacePlaneInitData","arr","val","i","splice","UFOObject","bulletAttack","impactAttack","health","bulletSpeed","bulletFre","coin","setItem","stringify","rocketObject","speed","waveRobotObject","spacePlaneObject","onLoad","start","update","dt"],"mappings":"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","file":"enemyControl.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const ENEMYTYPE_1 = ['UFO','rocket'];\nconst ENEMYTYPE_2 = ['UFO','rocket','waveRobot','throwRobot'];\nconst ENEMYTYPE_3 = ['UFO','rocket','waveRobot','throwRobot','spacePlane','heavyWaterPlane'];\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        UFOPrefab: cc.Prefab,\n        rocketPrefab: cc.Prefab,\n        waveRobotPrefab: cc.Prefab,\n        throwRobotPrefab: cc.Prefab,\n        spacePlanePrefab: cc.Prefab,\n        heavyWaterPlanePrefab: cc.Prefab,\n\n        enemyNumberBar: cc.ProgressBar,\n        failButton: cc.Node,\n    },\n\n    initLevelData() {\n        let levelData = JSON.parse(cc.sys.localStorage.getItem(\"levelData\")); // 获取全局对象\n        return levelData;\n    },\n\n    init() {\n        this.levelData = this.initLevelData(); // 获得关卡数据\n        // 为什么makeDoneFlag 为 -1 ？？？\n        this.makeDoneFlag = -1; // 有点奇怪初始值为-1，这个变量为标志位，当它的值等于敌人的数量时，说明敌人的生成已经完成\n        this.enemyArray = [];\n        this.failButton.active = false; // 初始让失败按钮不可见\n        this.enemyNumberBar.node.active = false; //初始让敌人条不可见\n    },\n\n    startGame() {\n        this.gameState = 1; // 游戏开始的标记\n        let enemyNumber = this.levelData.enemyNumber; // 获得敌人数量\n        this.remainEnemy = this.levelData.enemyNumber;// 让剩余敌人的变量等于初始人数\n        /********************************************/\n        /*this.UFOTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.UFOProportion);//生成总的UFO数量\n        this.makeUFOEnemyNumber = 0; // 这个用来计数生成的UFO数量\n\n        this.rocketTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.rocketProportion);//生成总的rocket数量\n        this.makeRocketEnemyNumber = 0; // 这个用来计数生成的rocket数量\n\n        this.waveRobotTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.waveRobotProportion);//生成总的wave数量\n        this.makeWaveRobotEnemyNumber = 0; // 这个用来计数生成的wave数量\n\n        this.spacePlaneTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.spacePlaneProportion);\n        this.makeSpacePlaneEnemyNumber = 0;\n\n        this.throwRobotTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.throwRobotProportion);\n        this.makeThrowRobotEnemyNumber = 0;\n\n        this.heavyPlaneTotalNumber = Math.floor(this.levelData.enemyNumber * this.levelData.enmeyProportion.heavyPlaneProportion);\n        this.makeHeavyPlaneEnemyNumber = 0;*/\n        /********************************************/\n        ///以下用创建敌人函数代替\n        this.makeEnemy = () => {\n            let enemyFlag = this.randomEnemy(); //获取到随机生成的敌人\n\n            if (enemyFlag == 'UFO' ) {\n                this.creatUFOEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'rocket') {\n                this.creatRocketEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'waveRobot') {\n                this.creatWaveRobotEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'spacePlane') {\n                this.creatSpacePlaneEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'throwRobot') {\n                this.creatThrowRobotEnemy();\n                this.makeDoneFlag++;\n            }\n            if (enemyFlag == 'heavyWaterPlane') {\n                this.creatHeavyWaterPlaneEnemy();\n                this.makeDoneFlag++;\n            }\n            cc.log(enemyFlag);\n        }\n        this.schedule(this.makeEnemy, 2, enemyNumber);\n        this.enemyNumberBar.node.active = true; //开始游戏后敌人条可见\n    },\n    randomEnemy() {\n        let enemyFlag = null;\n        if(this.levelData.level <=5){\n            let randomNumber = Math.floor(Math.random()*ENEMYTYPE_1.length);\n            enemyFlag = ENEMYTYPE_1[randomNumber];\n        }\n        if(this.levelData.level >5 && this.levelData.level <=10){\n            let randomNumber = Math.floor(Math.random()*ENEMYTYPE_2.length);\n            enemyFlag = ENEMYTYPE_2[randomNumber];\n        }\n        if(this.levelData.level >10 ){\n            let randomNumber = Math.floor(Math.random()*ENEMYTYPE_3.length);\n            enemyFlag = ENEMYTYPE_3[randomNumber];\n        }\n        return enemyFlag;\n    },\n    creatUFOEnemy() {\n        // 创建UFO\n        let enemy = cc.instantiate(this.UFOPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        this.makeUFOEnemyNumber++;\n    },\n    creatRocketEnemy() {\n        // 创建火箭\n        let enemy = cc.instantiate(this.rocketPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        this.makeRocketEnemyNumber++;\n    },\n    creatWaveRobotEnemy() {\n        // 创建波动机器人\n        let enemy = cc.instantiate(this.waveRobotPrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        this.makeWaveRobotEnemyNumber++;\n        cc.log('CWaveRobot');\n    },\n    creatSpacePlaneEnemy() {\n        // 创建深空飞船\n        let enemy = cc.instantiate(this.spacePlanePrefab);\n        enemy.parent = this.node;\n        this.enemyArray.push(enemy);\n        this.makeSpacePlaneEnemyNumber++;\n        cc.log('CSpacePlane');\n    },\n    creatThrowRobotEnemy() {\n        // 创建投掷机器人\n        cc.log('CThrowRobot');\n    },\n    creatHeavyWaterPlaneEnemy() {\n        // 创建重水飞船\n        cc.log('CHeavyWaterPlane');\n    },\n\n    succeedEventEmit() {\n        if (this.gameState == 1) { // gameState代表游戏状态 0：未开始，1：开始\n            this.enemyArray.map((item) => {\n                if (item.active == false) {\n                    item.parent = null;\n                    this.removeByValue(this.enemyArray, item);\n                    this.remainEnemy--; // 每移出一个敌人剩余敌人数减1\n                }\n            });\n            if ((this.makeDoneFlag == this.levelData.enemyNumber) && (this.enemyArray.length == 0)) {\n                this.node.emit(\"succeed\");\n                this.makeDoneFlag = -1;\n                this.gameState = 0;\n            }\n        }\n    },\n\n    popFailButton() {\n        //弹出失败重来按钮\n        this.failButton.active = true;\n        this.gameState = 0; // gameState == 0,表明游戏结束\n    },\n\n    updateEnemyNumberBar() {\n        // 更新敌人数量条\n        if (this.gameState == 1) {\n            let ratio = this.remainEnemy / this.levelData.enemyNumber;\n            this.enemyNumberBar.progress = ratio;\n        }\n    },\n\n    clearAllEnemy() {\n        // 停止所有计时器\n        // 将全局数组里面的敌人都销毁就好了\n        this.unscheduleAllCallbacks();\n        this.enemyArray.map((item) => {\n            item.parent = null;\n            item.destroy(); //销毁数组中的节点\n        });\n        this.enemyArray = []; //清空数组\n        this.makeDoneFlag = -1; // 将标志位设回原样\n    },\n\n    initEnemyData() {\n        // 这里必须初始化一次，否则第一次进游戏会出错\n        this.UFOInitData();\n        this.rocketInitData();\n        this.waveRobotInitData();\n        this.spacePlaneInitData();\n    },\n\n    // 删除数组特定元素的方法\n    removeByValue(arr, val) {\n        for (let i = 0; i < arr.length; i++) {\n            if (arr[i] == val) {\n                arr.splice(i, 1);\n                break;\n            }\n        }\n    },\n\n\n\n    /*初始化数据*/\n    UFOInitData() {\n        this.UFOObject = JSON.parse(cc.sys.localStorage.getItem(\"UFOObject\")); // 获取全局对象\n        if (this.UFOObject == null) {\n            this.UFOObject = {\n                bulletAttack: 20, // 子弹攻击力\n                impactAttack: 40, // 撞击攻击力\n                health: 100,  // 初始血量\n                bulletSpeed: 10, // 初始子弹速度\n                bulletFre: 2.5, // 子弹频率\n                coin: 100,\n            };\n            cc.sys.localStorage.setItem(\"UFOObject\", JSON.stringify(this.UFOObject));\n        } // 初始化数据\n    },\n    rocketInitData() {\n        this.rocketObject = JSON.parse(cc.sys.localStorage.getItem(\"rocketObject\")); // 获取全局对象\n        if (this.rocketObject == null) {\n            this.rocketObject = {\n                impactAttack: 40, // 撞击攻击力\n                health: 50,  // 初始血量\n                speed: 5, // 初始速度\n                coin: 200,\n            };\n            cc.sys.localStorage.setItem(\"rocketObject\", JSON.stringify(this.rocketObject));\n        } // 初始化数据\n    },\n    waveRobotInitData() {\n        this.waveRobotObject = JSON.parse(cc.sys.localStorage.getItem(\"waveRobotObject\")); // 获取全局对象\n        if (this.waveRobotObject == null) {\n            this.waveRobotObject = {\n                bulletAttack: 50, // 子弹攻击力\n                impactAttack: 120, // 撞击攻击力\n                health: 250,  // 初始血量\n                bulletSpeed: 5, // 初始子弹速度\n                bulletFre: 4, // 子弹频率\n                coin: 300,\n            };\n            cc.sys.localStorage.setItem(\"waveRobotObject\", JSON.stringify(this.waveRobotObject));\n        } // 初始化数据\n    },\n    spacePlaneInitData() {\n        this.spacePlaneObject = JSON.parse(cc.sys.localStorage.getItem(\"spacePlaneObject\")); // 获取全局对象\n        if (this.spacePlaneObject == null) {\n            this.spacePlaneObject = {\n                bulletAttack: 200, // 子弹攻击力\n                impactAttack: 600, // 撞击攻击力\n                health: 800,  // 初始血量\n                bulletSpeed: 1, // 初始子弹速度\n                bulletFre: 4, // 子弹频率\n                coin: 700,\n            };\n            cc.sys.localStorage.setItem(\"spacePlaneObject\", JSON.stringify(this.spacePlaneObject));\n        } // 初始化数据\n    },\n    /**********************/\n\n    onLoad() {\n        this.enemyNumberBar.progress = -1;\n    },\n\n    start() {\n\n    },\n\n    update(dt) {\n        this.succeedEventEmit();\n        this.updateEnemyNumberBar();\n        //cc.log('enemy:'+this.enemyArray.length);\n        //cc.log('flag:'+this.makeDoneFlag)\n    },\n});\n"]}